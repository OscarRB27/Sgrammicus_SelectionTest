Admixture

1) Nos ubicamos en la carpeta Sgrammicus_Selection para trabajar

2) Transformamos la base de datos .vcf a un formato plink y las salidas de los archivos son .ped y .map

vcftools --vcf Data/Raw_Data/Sg_Pols2M_7000snps.vcf --plink --out Data/Admixture/Formats/Sgram_Plink

2) Insertamos la palabra "Scaffold_" al principio de todas las líneas del archivo .map, que son los nombres de los cromosomas. Ya que si no ponemos esto no se podrá transformar a un archivo de entrada para Admixture.

sed -i '.bak' 's/^/Scaffold_/' Data/Admixture/Formats/Sgram_Plink.map

3) Transformamos los archivos Sgram_Plink editado y se usa el archivo Sgram_Admixture.ped como entrada de Admixture

plink --file Data/Admixture/Formats/Sgram_Plink --recode12 --allow-extra-chr --out Data/Admixture/Formats/Sgram_Admixture

4) Nos movemos a la carpeta Result de admixture

cd Result/Admixture/Results 

5) Corremos Admixture usando el siguiente loop para obtener los resultados

for K in 1 2 3 4 5 6 7 8 9 10; 
do admixture --cv=10 -s 123 -B=2000 ../../../Data/Admixture/Formats/Sgram_Admixture.ped $K -j6 | tee log${K}.out; 
done
