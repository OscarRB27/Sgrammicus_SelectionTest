#SNPs database
Sg.vcf<-read.vcfR("Data/Raw_Data/Sg_Pols2M_7000snps.vcf")
#Transform SNPs database to genind object
Sg.gen<-vcfR2genind(Sg.vcf)
#Definition of localities as populations
pop(Sg.gen)<-Sg.data$k
popNames(Sg.gen)
pop(Sg.gen)
##Transform genind object to fstast
Sg.fstat<-genind2hierfstat(Sg.gen)
Sg.basic.ss<-basic.stats(Sg.gen)
Sg.basic.ss
Sg.basic.ss<-summary(Sg.gen)
Sg.basic.ss<-summary(Sg.gen)
Sg.basic.ss<-basic.stats(Sg.gen)
Sg.basic.ss.ind<-summary(Sg.gen)
Sg.basic.ss.ind<-summary(Sg.gen)
Sg.basic.ss.ind
Sg.basic.ss$Fis
Sg.basic.ss$n.ind.samp
Sg.basic.ss$perloc
Sg.basic.ss$pop.freq
Sg.basic.ss$overall
(Sg.het<-cbind(Ho,Hs))
#Obtain the observed heterozygosity
Sg.Ho<-Sg.basic.ss$Ho
#Imputation of NAs of the base of Ho by groups
Sg.Ho<-apply(Sg.Ho,2,function(x)replace(x, is.na(x),
as.numeric(names(which.max(table(x))))))
#Calculation of the average of Ho for each group
Ho<-apply(Sg.Ho,MARGIN=2,FUN=mean) %>% round(digits=4)
#Obtain the expected heterozygosity
Sg.Hs<-Sg.basic.ss$Hs
#Imputation of NAs of the base of Ho by groups
Sg.Hs<-apply(Sg.Hs,2,function(x)replace(x, is.na(x),
as.numeric(names(which.max(table(x))))))
#Calculation of the average of Ho for each group
Hs<-apply(Sg.Hs,MARGI =2,FUN=mean) %>% round(digits=4)
(Sg.het<-cbind(Ho,Hs))
Sg.data
str(Sg.het)
Sg.het<-as.data.frame(Sg.het)
str(Sg.het)
Sg.het
str(Sg.het)
colnames(Sg.het)[1:3]<-c("K","Ho","Hs")
Sg.het
View(Sg.het)
par(mfrow=c(1,2))
barplot(colMeans(Ho_Sgram,na.rm=T),las=2,main="Heterocigosidad Observada",col="blue")
barplot(colMeans(Sg.Ho,na.rm=T),las=2,main="observed heterozygosity",col="blue")
barplot(colMeans(Sg.Hs,na.rm=T),las=2,main="Expected heterozygosity",col="orange")
par(mfrow=c(1,2))
barplot(colMeans(Sg.Ho,na.rm=T),las=2,main="observed heterozygosity",col="blue")
barplot(colMeans(Sg.Hs,na.rm=T),las=2,main="Expected heterozygosity",col="orange")
par(mfrow=c(1,2))
barplot(colMeans(Sg.Ho,na.rm=T),las=2,main="observed heterozygosity",col="blue")
barplot(colMeans(Sg.Hs,na.rm=T),las=2,main="Expected heterozygosity",col="orange")
par(mfrow=c(1,2))
barplot(colMeans(Sg.Ho,na.rm=T),las=2,main="observed heterozygosity",col="blue")
barplot(colMeans(Sg.Hs,na.rm=T),las=2,main="Expected heterozygosity",col="orange")
par(mfrow=c(1,2))
barplot(colMeans(Sg.Ho,na.rm=T),las=2,main="Observed heterozygosity",col="blue")
barplot(colMeans(Sg.Hs,na.rm=T),las=2,main="Expected heterozygosity",col="orange")
#Nei
(Sg.Nfst<-pairwise.neifst(Sg.fstat))
#Weir & cockerham
(Sg.WCfst<-pairwise.WCfst(Sg.fstat))
par(mfrow=c(1,2))
corrplot(Sg.Nfst,is.corr=FALSE,
method="square",
type="lower",
col=rev(heat.colors(100)),
diag=FALSE,
tl.col="black",
addCoef.col=TRUE,
addgrid.col="black",
tl.cex=0.8,
cl.length=5)
corrplot(Sg.WCfst,is.corr=FALSE,
method="square",
type="lower",
col=rev(heat.colors(100)),
diag=FALSE,
tl.col="black",
addCoef.col = T,
addgrid.col = "black",
tl.cex=0.8,
cl.length=5)
#FST based in Nei
corrplot(Sg.Nfst,is.corr=FALSE,
method="square",
type="lower",
col=rev(heat.colors(100)),
diag=FALSE,
tl.col="black",
addCoef.col=TRUE,
addgrid.col="black",
tl.cex=0.8,
cl.length=5)
#FST based in Weir and Cockerham
corrplot(Sg.WCfst,is.corr=FALSE,
method="square",
type="lower",
col=rev(heat.colors(100)),
diag=FALSE,
tl.col="black",
addCoef.col = T,
addgrid.col = "black",
tl.cex=0.8,
cl.length=5)
View(Sg.data)
#ID and location database information
Sg.data<-read.table("Data/Pop_Info/K_Pops.txt",sep="\t",header=T)
View(Sg.data)
#Definition of localities as populations
pop(Sg.gen)<-Sg.data$k
##Transform genind object to fstast
Sg.fstat<-genind2hierfstat(Sg.gen)
View(Sg.fstat)
Sg.het<-as.data.frame(Sg.het)
Sg.het
summary(Sg.data$k)
(Sg.data$k)
ggplot(Sg.het,x=Sg.het$Ho)
ggplot(Sg.het,x=Sg.het$Ho,y=Sg.het$Hs)
k<-sample(c("K1","K2","K3"))
Sg.het<-data.frame(Sg.het,k)
Sg.het
k<-sample(c("K3","K1","K2"))
Sg.het<-data.frame(Sg.het,k)
Sg.het
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
Sg.het
k<-sample(c("K3","K1","K2"))
Sg.het<-data.frame(Sg.het,k)
Sg.het
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-sample(c("K2","K1","K3"))
Sg.het<-data.frame(Sg.het,k)
Sg.het
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-sample("K1","K2","K3")
k<-sample(c("K1","K2","K3"))
Sg.het<-data.frame(Sg.het,k)
(Sg.het<-data.frame(Sg.het,k))
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-sample(c("K2","K3","K1"))
(Sg.het<-data.frame(Sg.het,k))
k<-sample(c("K3","K1","K2"))
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-sample(c("K3","K1","K2"))
(Sg.het<-data.frame(Sg.het,k))
str(Sg.het)
k<-as.factor(sample(c("K3","K1","K2")))
(Sg.het<-data.frame(Sg.het,k))
str(Sg.het)
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K3","K1","K2")))
(Sg.het<-data.frame(Sg.het,k))
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K1","K2","K3")))
cbind(Sg.het,k)
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K_1","K_2","K_3")))
cbind(Sg.het,k)
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("1K","2K","3K")))
cbind(Sg.het,k)
(Sg.het<-data.frame(Sg.het,k))
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("3K","2K","1K")))
cbind(Sg.het,k)
(Sg.het<-cbind(Ho,Hs))
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K3","K2","K1")))
cbind(Sg.het,k)
Sg.het<-cbind(Ho,Hs)
K<-as.factor(sample(c("K3","K2","K1")))
cbind(Sg.het,K)
Sg.het<-as.data.frame(Sg.het)
Sg.het
cbind(Sg.het,K)
k
Sg.het<-cbind(Ho,Hs)
str(Sg.het)
Sg.het<-as.data.frame(Sg.het)
str(Sg.het)
k<-as.factor(sample(c("K3","K2","K1")))
cbind(Sg.het,k)
Sg.het<-cbind(Ho,Hs)
cbind(Sg.het,k)
Sg.het<-cbind(Ho,Hs)
k<-as.factor(sample(c("K3","K2","K1")))
cbind(Sg.het,k)
Sg.het<-cbind(Ho,Hs)
Sg.het<-cbind(Ho,Hs)
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K3","K2","K1")))
cbind(Sg.het,k)
Sg.het<-as.data.frame(Sg.het)
Sg.het
Sg.het<-cbind(Sg.het,k)
Sg.het
k<-as.factor(sample(c("K1","K2","K3")))
Sg.het<-cbind(Sg.het,k)
(Sg.het<-cbind(Sg.het,k))
k<-as.factor(sample(c("K1","K3","K2")))
(Sg.het<-cbind(Sg.het,k))
Sg.het<-cbind(Ho,Hs)
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K1","K3","K2")))
(Sg.het<-cbind(Sg.het,k))
Sg.het<-cbind(Ho,Hs)
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K1","K2","K3")))
(Sg.het<-cbind(Sg.het,k))
Sg.het<-cbind(Ho,Hs)
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K3","K2","K1")))
(Sg.het<-cbind(Sg.het,k))
Sg.het<-cbind(Ho,Hs)
Sg.het<-as.data.frame(Sg.het)
k<-as.factor(sample(c("K2","K3","K1")))
(Sg.het<-cbind(Sg.het,k))
Sg.het
Sg.het
str(Sg.het)
ggplot(Sg.het,x=Sg.het$k,y=Sg.het$Hs)
ggplot(Sg.het,aes(x=Sg.het$k,y=Sg.het$H0))
ggplot(Sg.het,aes(x=k,y=Ho))
Sg.het
ggplot(Sg.het,aes(x=k,y=Ho))
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity")
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",col="K")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",col="k")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",color="k")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",color=k)+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",color=k,fill=k)+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",fill=k)+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.7,color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="white")+
scale_color_brewer(palette="Dark2")++
theme_bw()
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="white")+
scale_color_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank())
geom_bar(stat="identity",width=0.5,color=k,fill="steelblue)+
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k,fill="steelblue")+
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k, fill=c("red","green","blue"))+
scale_color_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k, fill=k)+
scale_color_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color=k)+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho))+
geom_bar(stat="identity",width=0.5,color="black")+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.5,color="black")+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank())
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank(),legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
theme(axis.title.x=element_blank(),axis.title.y="Observed heterozygosity",legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Teeth length")+
theme(axis.title.x=element_blank(),legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=8),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=20),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=12),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=10),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity",size=11)+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=10),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=10),
axis.title.y = element_text(size=12, face="bold"),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=10),
axis.title.y = element_text(size=12),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
par(mfrow=c(1,2))
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Hs,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Expected heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
par(mfrow=c(1,2))
ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
ggplot(Sg.het,aes(x=k,y=Hs,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Expected heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
install.packages("patchwork")
library(patchwork)
Sg.Ho.plot<-ggplot(Sg.het,aes(x=k,y=Ho,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Observed heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
Sg.Hs.plot<-ggplot(Sg.het,aes(x=k,y=Hs,fill=k))+
geom_bar(stat="identity",width=0.7,color="black")+
scale_fill_brewer(palette="Dark2")+
theme_bw()+
ylab("Expected heterozygosity")+
theme(axis.title.x=element_blank(),
axis.text.x=element_text(size=9),
axis.text.y=element_text(size=9),
axis.title.y = element_text(size=12),
legend.position="none")
Sg.Ho.plot+Sg.Hs.plot
#FST based in Nei
Sg.fst.plot<-corrplot(Sg.Nfst,is.corr=FALSE,
method="square",
type="lower",
col=rev(heat.colors(100)),
diag=FALSE,
tl.col="black",
addCoef.col=TRUE,
addgrid.col="black",
tl.cex=0.8,
cl.length=5)
